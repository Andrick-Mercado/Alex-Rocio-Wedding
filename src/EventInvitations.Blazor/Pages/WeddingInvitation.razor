
@using PersonalPortfolio.Library.Domain
@inject Library.Infrastructure.IWebsiteRepo WebsiteRepo
@inject IJSRuntime JS

<div class="hero" style="background-image:url('@(_wedding?.HeroBackgroundImage)');">
    <canvas id="snow-canvas"></canvas>
    <div class="hero-content">
        <h1 class="couple">@(_wedding?.CoupleNames)</h1>
        <p class="date">@(_wedding?.DateText)</p>
        <p class="subtitle">@(_wedding?.Subtitle)</p>
    </div>
    <div class="scroll-indicator">@(_wedding?.ScrollIndicatorText)</div>
</div>

@foreach (var sec in _wedding?.Sections ?? new List<WeddingSection>())
{
    <section class="@(sec.AltStyle ? "fade-section alt" : "fade-section")">
        <div class="@(sec.Reverse ? "section-inner reverse" : "section-inner")">
            @if (sec.Reverse)
            {
                <div class="section-text">
                    <h2>@sec.Title</h2>
                    @foreach (var p in sec.Paragraphs ?? new List<string>())
                    {
                        <p>@p</p>
                    }
                </div>
                <img src="@sec.Image" alt="@sec.ImageAlt" class="section-image" />
            }
            else
            {
                <img src="@sec.Image" alt="@sec.ImageAlt" class="section-image" />
                <div class="section-text">
                    <h2>@sec.Title</h2>
                    @foreach (var p in sec.Paragraphs ?? new List<string>())
                    {
                        <p>@p</p>
                    }
                </div>
            }
        </div>
    </section>
}

<footer class="footer">
    <p>@(_wedding?.FooterText)</p>
</footer>

@code {
    private PersonalPortfolio.Library.Domain.WeddingInvitation _wedding;

    protected override async Task OnInitializedAsync()
    {
        var siteData = await WebsiteRepo.GetWebsiteData();
        _wedding = siteData.WeddingInvitation;
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JS.InvokeVoidAsync("weddingSnow.init");
            await JS.InvokeVoidAsync("scrollFade.init");
        }
    }
}